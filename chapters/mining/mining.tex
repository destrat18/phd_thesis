\chapter{Optimal Block Production Problem}
\label{chp:mining}
This chapter originally appeard in the following publications:

\begin{itemize}

    \item T. Barakbayeva, S. Farokhnia, A.K. Goharshady, S. Novozhilov, Boosting Gas Revenues of Ethereum Miners, IEEE/ACM International Conference on Software Engineering, ICSE 2026
    \item T. Barakbayeva, S. Farokhnia, A.K. Goharshady, M. Gufler, S. Novozhilov, Pixiu: Optimal Block Production Revenues on Cardano, IEEE International Conference on Blockchain, Blockchain 2024
\end{itemize}


\newpage

\section{Introduction}

\para{Background} In modern cryptocurrencies, a blockchain is a linked-list of blocks, which in turn contain a sequence of transactions. Anyone on the network can create and broadcast a transaction, but the transaction is only considered finalized when it is added to the blockchain. The blockchain is subject to consensus, i.e.~all nodes on the network will eventually agree on its contents. The consensus mechanism varies by cryptocurrency. For example, Bitcoin uses proof of work, whereas Ethereum runs on proof of stake. Irrespective of this, all modern cryptocurrencies heavily rely on miners. These are nodes who actively partake in running the consensus mechanism and extending the blockchain by adding new blocks. To incentivize the miners to add new transactions to the blockchain, each transaction includes a fee, which is paid to the miner who includes it in her block. This setting creates a natural optimization problem from the point-of-view of miners: Given a set of new transactions which are not yet added to the blockchain, how can we form an optimal block that maximizes the fees and thus the miner's revenue?


In this chapter, we address this optimization problem for two mainstream cryptocurrencies:
\begin{enumerate}
    \item \textbf{Cardano:} A blockchain protocol based on proof-of-stake and an extended UTXO model which also supports arbitrary smart contracts. Its primary currency, Ada, is currently one of the global top ten cryptocurrencies with a market cap of more than 16 billion USD. In Cardano, new blocks are produced by stake pools. Any holder of Ada can delegate their stake to a pool. The underlying proof-of-stake consensus protocol is Ouroboros Praos, which divides time into a number of epochs and each epoch into a number of slots, each corresponding to one second. In each slot, leaders are randomly selected to produce and add new blocks to the blockchain, with their selection probability being proportional to their stake. Each block can contain a sequence of transactions and block production is rewarded in two ways: (i)~transaction fees and (ii)~monetary expansion. The producers have no control over (ii), but can optimize (i) by choosing which transactions to include in their blocks. Thus, they are incentivized to maximize the total transaction fees.

    \item \textbf{Ethereum:} Currently world's largest programmable blockchain by market cap. On Ethereum, the fees depend on the execution costs of the transaction. Given that Ethereum supports arbitrary smart contracts in a Turing-complete language, the fee paid by a transaction can depend on the context in which it is executed, which is determined by the set of transactions that precede it on the blockchain. Thus, the problem becomes considerably more challenging. An Ethereum miner who wishes to maximize her revenue has to choose not only a subset of transactions to include in her block, but also their exact order. Moreover, each permutation of the same transactions might change the amount of fee paid by each transaction. This causes a combinatorial explosion.

\end{enumerate}
  		
	

\para{Our Contributions} This chapter provides algorithms and empirical results for optimal block production on Cardano and Ethereum:

\begin{enumerate}
    \item \textbf{Cardano.} In Section~\ref{sec:mining-cardano-problem}, we formalized the block production problem on Cardano. Then, in Section~\ref{sec:mining-cardano-algorithm}, we show that by exploiting the sparsity of interrelations between transactions, i.e.~the small treedepth of dependency-conflict graphs, it is possible to obtain a polynomial-time algorithm that outputs optimal blocks. In Section~\ref{sec:mining-cardano-experiments}, we implemented our algorithm in a free and open-source tool called Pixiu. Using Pixiu, we provide extensive experimental results over real-world transaction data on the Cardano blockchain, demonstrating that our approach increases the block producers' revenue by almost 1,357.82 USD/day (= 495,604.3 USD/year).

    \item \textbf{Ethereum.} Sections~\ref{sec:mining-ethereum-problem} and~\ref{sec:mining-ethereum-algorithm} study the block production problem for Ethereum and introduce a randomized framework for increasing miners' transaction-fee revenues. The framework combines testing, decision trees, integer linear programming, and localization techniques to ameliorate the combinatorial explosion. Finally, Section~\ref{sec:mining-ethereum-experiments} reports significant empirical gains: our method outperforms real-world Ethereum miners by an average of 73.45\% per block, corresponding to roughly 63 million USD per annum.
\end{enumerate}




% Cardano Mining Paper
\input{chapters/mining/mining-cardano-problem.tex}
\input{chapters/mining/mining-cardano-algorithms.tex}
\input{chapters/mining/mining-cardano-experiments.tex}


% Ethereum Mining Paper
\input{chapters/mining/mining-ethereum-problem.tex}
\input{chapters/mining/mining-ethereum-algorithm.tex}
\input{chapters/mining/mining-ethereum-experiments.tex}