\section{Attack Cost} \label{sec:attack}

\subsection{Double-Spending Attack Success Rate}

Suppose $H$ is the total Bitcoin hashrate where $pH$ represents honest participants and $qH$ represents attackers' hash-rate, where $p+q = 1$. 

When a merchant's transaction is included in a block with a height of $B_0$, they must wait for $n$ blocks to ensure that the transaction has been successfully confirmed by honest participants since block height $B_0$. However, an attacker may be simultaneously mining a private chain with a height of $m$ from block $B_0$. 

This work~\cite{rosenfeld2014analysis} explains that to determine the probability of a successful double-spending attack, we can utilize a negative binomial variable. This model considers $m$ as the number of successes (blocks discovered by the attacker) before $n$ failures (blocks found by the honest network), with a probability of $q$ for success. Thus, the probability $r$ of a successful double-spend attack based on the confirmation block number n and q attacker's hash-rate is:
$$
r = 
\begin{cases}
    1-\sum_{m=0}^{n} \binom{m+n-1}{m}(p^n q^m - p^m q^n) & if\ q < p\\
    1 & if\ q >= p 
\end{cases}
$$

By using this formula, we can calculate the probability of a successful attack based on the confirmation block n and the attachker's hash-rate q in Table~\ref*{table:prob-succ}.

\begin{table}[H]
    % \centering
    \include{tables/prob-succ}
    \caption{Each cell shows the percentage of successful double-spending attack with confirmation blocks number $n$ and attachker's hash-rate $q$.}
    \label{table:prob-succ}
\end{table}

\todo{Check newer papers to get more accurate estimates}

\subsection{Hardware Cost}
For Bitcoin mining, ASICs are the superior option in terms of both speed and efficiency compared to GPUs. As a result, they are the practical choice for the majority of unknown2023bitcoin~\cite{\url{https:Asic}. There are a number of common ASICs listed in Table~\ref{table:asic} along with their TH/s (TeraHash) and their costs in US dollars.

\begin{table}[H]
    \centering
    \include{tables/asic}
    \caption{Hash-rate and cost for 5 common ASICs.}
    \label{table:asic}
\end{table}
Through this paper we will use ``Antminer S19 Pro'' since it's among popular choice by unknown2023bitcoin~\cite{\url{https:10BestAsic}.

\todo{Update list of ASICs and Their prices}

\todo{Get estimation from marketplaces such as nicehash}

\subsection{Bitcoin Network Hash-Rate}
The Bitcoin hash rate $H$ estimates the number of hashes being generated by unknown2023bitcoin creating a block. Current rate is 443.38 EH/s (ExaHash).

\todo{average hash rate in a month :-?}

\subsection{Repeated Experiments}
By repeating the double-spend attack explained earlier, the chances of errors decrease and reliability improves. We can therefore model it as a simple Binomial Distribution, which considers the repeated trials based on success probabilities $r$ calculated in Table 1 and this formula:
$$
r' = 1 - (1-r)^n
$$

\subsection{Cost of Repeated Experiments}

For every value of $n$ and $q$, we calculate the probability $r'$ of at least one successful attack after $k$ repetitions. The cost of the attack $c_a$ depends on the number of unknownnoyearasic hardware needed to match $qH$, which is determined by the unknownnoyearasic hash-rate ($H_{asic}$) and $q$. To determine the cost, we use the following formula:
$$
C_a = \frac{qH}{H_{\text{asic}}}C_{\text{asic}}
$$

Which in this experiments $H_{asic}$ is 110 TH/s and $C_{\text{asic}}$ is $2860$ USD.

We rounded $r'$ to three decimal digits once we calculated the probability $r'$ for each $n$, $q$, and $k$. Our table~\ref{table:cost} provides the cost for the lowest number of repetitions $k$ required to achieve the highest probability for every $n$ and $q$.

\todo{Must include cost of Electricity based on $k$}

\begin{table}[H]
    \centering
    \include{tables/cost}
    \caption{Cost table}
    \label{table:cost}
\end{table}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{figures/poolHashrate.pdf}
    
    \caption{The attack threshold is the minimum amount of hashrate required to perform a mining pool attack, which is 18\% of the total hashrate. }
    \label{fig:poolHashrate}
\end{figure}
